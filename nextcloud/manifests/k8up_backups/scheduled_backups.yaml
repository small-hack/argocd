---
apiVersion: k8up.io/v1
kind: Schedule
metadata:
  name: scheduled-backups-nextcloud-b2
  namespace: nextcloud
spec:
  failedJobsHistoryLimit: 10
  successfulJobsHistoryLimit: 10
  backend:
    repoPasswordSecretRef:
      name: k8up-restic-b2-repo-pw-nextcloud
      key: password
    s3:
      endpoint: s3.eu-central-003.backblazeb2.com
      bucket: vmt-ncloud
      accountIDSecretRef:
        name: k8up-b2-creds-nextcloud
        key: applicationKeyId
      accountKeySecretRef:
        name: k8up-b2-creds-nextcloud
        key: applicationKey
  backup:
    # daily at 10:10AM (UTC)
    schedule: '10 10 * * *'
    failedJobsHistoryLimit: 10
    successfulJobsHistoryLimit: 2
    ## optional
    # promURL: https://prometheus-io-instance:8443
    promURL: http://prometheus-helm-chart-kube-prometheus.monitoring:100100/
    podSecurityContext:
      runAsUser: 0
  check:
    # daily at 10:20 AM (UTC)
    schedule: '20 10 * * *'
    ## optional
    # promURL: https://prometheus-io-instance:8443
  prune:
    # daily at 10:30 AM (UTC)
    schedule: '30 10 * * *'
    retention:
      keepDaily: 7
      keepWeekly: 8
