apiVersion: v1
kind: Secret
metadata:
  name: postgres-init-script
type: Opaque
stringData:
  # CREATE USER supabase-auth-admin NOINHERIT CREATEROLE LOGIN NOREPLICATION PASSWORD 'mysecurepassword'; 
  init.sql: |
    BEGIN;
    CREATE USER supabaseadmin LOGIN CREATEROLE CREATEDB REPLICATION BYPASSRLS;
    CREATE USER supabaseauthadmin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    CREATE SCHEMA IF NOT EXISTS auth AUTHORIZATION supabaseauthadmin;
    GRANT CREATE ON DATABASE postgres TO supabaseauthadmin;
    ALTER USER supabaseauthadmin SET search_path = 'auth';
    CREATE DATABASE appflowy;
    CREATE USER appflowy LOGIN NOINHERIT CREATEROLE CREATEDB NOREPLICATION;
    GRANT CREATE ON DATABASE postgres TO appflowy;
    GRANT CREATE ON DATABASE appflowy TO appflowy;
    COMMIT;
