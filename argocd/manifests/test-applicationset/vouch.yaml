apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: vouch
spec:
  generators:
  - plugin:
      configMapRef:
        name: argocd-generator-plugin-cm
      input:
        parameters:
          key1: value1
  template:
    metadata:
      name: vouch
    spec:
      project: default
      source:
        repoURL: 'https://vouch.github.io/helm-charts/'
        targetRevision: 3.1.0
        chart: vouch
        helm:
          values: |
            image:
              tag: 0.39.0
            existingSecretName: vouch-existing-secret
            ingress:
              enabled: true
              annotations:
                kubernetes.io/ingress.class: nginx
                cert-manager.io/cluster-issuer: letsencrypt-staging
              paths:
                - /
              hosts:
                - {{.vouch_hostname}}
              tls:
                - secretName: vouch-tls
                  hosts:
                    - {{.vouch_hostname}}
      destination:
        server: "https://kubernetes.default.svc"
        namespace: vouch
